<rules>
    <![CDATA[

data_requirement_rule User.{{AddPropertiesName}} (
    @Entity=OperatingSystem.Windows.WindowsHost,
    @DisplayName=@Entity.Hostname,
    @ReturnCompliantRecords=false
)

params (
    @expectedHash string
)

assert (
    @hash == @expectedHash
)

checkData {
    var @actualHashesArray = dynamic {
        hash = @Entity.AdditionalProperties.{{AddPropertiesName}};
    };

    filterByParameters(@actualHashesArray);

    if (@ComplianceCheckContext.NonCompliantRows.Any())
        return FAIL_NON_COMPLIANT;

    return SUCCESS;
}

]]>
</rules>
